{"version":3,"file":"index.es.js","sources":["../node_modules/style-inject/dist/style-inject.es.js","../src/utils/constants.ts","../src/hooks/usePrevious.ts","../src/services/contributions.ts","../src/utils/index.ts","../src/components/GitHubCalendar/index.tsx"],"sourcesContent":["function styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nexport default styleInject;\n","// GitHub theme\nexport type Theme = {\n  [key: string]: string;\n  background: string;\n  text: string;\n  grade4: string;\n  grade3: string;\n  grade2: string;\n  grade1: string;\n  grade0: string;\n};\n\nexport const DEFAULT_THEME = {\n  background: 'transparent',\n  text: '#000',\n  grade4: '#196127',\n  grade3: '#239a3b',\n  grade2: '#7bc96f',\n  grade1: '#c6e48b',\n  grade0: '#ebedf0',\n};\n\nexport const NAMESPACE = 'react-github-calendar';\n\nexport const LINE_HEIGHT = 1.5;\nexport const MIN_DISTANCE_MONTH_LABELS = 2;\nexport const TITLE_SCALE_FACTOR = 1.25;\n","import { useRef, useEffect } from 'react';\n\nexport function usePrevious<T>(value: T) {\n  const ref = useRef<T>(value);\n\n  useEffect(() => {\n    ref.current = value;\n  }, [value]);\n\n  return ref.current;\n}\n","// Import modules separately to reduce bundle size\nimport addDays from 'date-fns/addDays';\nimport format from 'date-fns/format';\nimport getDay from 'date-fns/getDay';\nimport getMonth from 'date-fns/getMonth';\nimport isAfter from 'date-fns/isAfter';\nimport isSameYear from 'date-fns/isSameYear';\nimport parseISO from 'date-fns/parseISO';\nimport setDay from 'date-fns/setDay';\nimport subYears from 'date-fns/subYears';\n\nconst API_URL = 'https://github-calendar.now.sh/v1/';\nconst DATE_FORMAT = 'yyyy-MM-dd';\n\nexport type GraphData = {\n  year: number;\n  blocks: Block[][];\n  monthLabels: { x: number; label: string }[];\n  totalCount: number;\n};\n\nexport type Block = {\n  date: string;\n  info?: {\n    date: string;\n    count: number;\n    color: string;\n    intensity: number;\n  };\n};\n\nexport type MonthLabels = {\n  x: number;\n  label: string;\n}[];\n\nexport type RequestOptions = {\n  fullYear: boolean;\n  username: string;\n  years: number[];\n};\n\ntype ApiResult = {\n  years: {\n    year: string;\n    total: number;\n    range: {\n      start: string;\n      end: string;\n    };\n  }[];\n  contributions: {\n    date: string;\n    count: number;\n    color: string;\n    intensity: number;\n  }[];\n};\n\nfunction getContributionsForDate(data: ApiResult, date: string) {\n  return data.contributions.find(contrib => contrib.date === date);\n}\n\nfunction getContributionCountForLastYear(data: ApiResult) {\n  const { contributions } = data;\n  const now = new Date();\n\n  // Start date for accumulating the values\n  const begin = contributions.findIndex(contrib => contrib.date === format(now, DATE_FORMAT));\n\n  // No data for today given\n  if (begin === -1) {\n    return 0;\n  }\n\n  // Check if there is data for the day one year past\n  let end = contributions.findIndex(contrib => {\n    return contrib.date === format(subYears(now, 1), DATE_FORMAT);\n  });\n\n  // Take the oldest contribution otherwise, if not enough data exists\n  if (end === -1) {\n    end = contributions.length - 1;\n  }\n\n  return contributions.slice(begin, end).reduce((acc, contrib) => acc + contrib.count, 0);\n}\n\nfunction getContributionCountForYear(data: ApiResult, year: number) {\n  const yearEntry = data.years.find(entry => entry.year === String(year));\n\n  return yearEntry ? yearEntry.total : 0;\n}\n\nfunction getBlocksForYear(year: number, data: ApiResult, fullYear: boolean) {\n  const now = new Date();\n  const firstDate = fullYear ? subYears(now, 1) : parseISO(`${year}-01-01`);\n  const lastDate = fullYear ? now : parseISO(`${year}-12-31`);\n\n  let weekStart = firstDate;\n\n  // The week starts on Sunday - add days to get to next sunday if neccessary\n  if (getDay(firstDate) !== 0) {\n    weekStart = addDays(firstDate, getDay(firstDate));\n  }\n\n  // Fetch graph data for first row (Sundays)\n  const firstRowDates = [];\n  while (weekStart <= lastDate) {\n    const date = format(weekStart, DATE_FORMAT);\n\n    firstRowDates.push({\n      date,\n      info: getContributionsForDate(data, date),\n    });\n\n    weekStart = setDay(weekStart, 7);\n  }\n\n  // Add the remainig days per week (column for column)\n  return firstRowDates.map(dateObj => {\n    const dates = [];\n    for (let i = 0; i <= 6; i += 1) {\n      const date = format(setDay(parseISO(dateObj.date), i), DATE_FORMAT);\n\n      if (isAfter(parseISO(date), lastDate)) {\n        break;\n      }\n\n      dates.push({\n        date,\n        info: getContributionsForDate(data, date),\n      });\n    }\n\n    return dates;\n  });\n}\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nfunction getMonthLabels(blocks: GraphData['blocks'], fullYear: boolean): MonthLabels {\n  const weeks = blocks.slice(0, fullYear ? blocks.length - 1 : blocks.length);\n  let previousMonth = 0; // January\n\n  return weeks.reduce<MonthLabels>((labels, week, x) => {\n    const firstWeekDay = parseISO(week[0].date);\n    const month = getMonth(firstWeekDay) + 1;\n    const monthChanged = month !== previousMonth;\n    const firstMonthIsDecember = x === 0 && month === 12;\n\n    if (monthChanged && !firstMonthIsDecember) {\n      labels.push({\n        x,\n        label: format(firstWeekDay, 'MMM'),\n      });\n      previousMonth = month;\n    }\n\n    return labels;\n  }, []);\n}\n\nfunction getGraphDataForYear(year: number, data: ApiResult, fullYear: boolean): GraphData {\n  const blocks = getBlocksForYear(year, data, fullYear);\n  const monthLabels = getMonthLabels(blocks, fullYear);\n  const totalCount = fullYear\n    ? getContributionCountForLastYear(data)\n    : getContributionCountForYear(data, year);\n\n  return {\n    year,\n    blocks,\n    monthLabels,\n    totalCount,\n  };\n}\n\nexport async function getGitHubGraphData(options: RequestOptions): Promise<GraphData[]> {\n  const { fullYear, username, years } = options;\n  const data: ApiResult = await (await fetch(API_URL + username)).json();\n\n  if (!data.years.length) {\n    throw Error('No data available');\n  }\n\n  return years.map(year => {\n    const isCurrentYear = isSameYear(parseISO(String(year)), new Date());\n\n    return getGraphDataForYear(year, data, isCurrentYear && fullYear);\n  });\n}\n","import color, { ColorInput } from 'tinycolor2';\n\nimport { DEFAULT_THEME, NAMESPACE, Theme } from './constants';\n\nexport function createCalendarTheme(\n  baseColor: ColorInput,\n  textColor = 'inherit',\n  emptyCellColor = color('white')\n    .darken(8)\n    .toHslString(),\n  background = 'transparent',\n): Theme {\n  const base = color(baseColor);\n\n  if (!base.isValid()) {\n    return DEFAULT_THEME;\n  }\n\n  const text = color(textColor).isValid() ? String(color(textColor)) : DEFAULT_THEME.text;\n\n  return {\n    background,\n    text,\n    grade4: base.setAlpha(0.92).toHslString(),\n    grade3: base.setAlpha(0.76).toHslString(),\n    grade2: base.setAlpha(0.6).toHslString(),\n    grade1: base.setAlpha(0.44).toHslString(),\n    grade0: emptyCellColor,\n  };\n}\n\nexport function getClassName(name: string, extra?: string) {\n  if (extra) {\n    return `${NAMESPACE}__${name} ${extra}`;\n  }\n\n  return `${NAMESPACE}__${name}`;\n}\n","import React, { useState, CSSProperties, useEffect, useCallback } from 'react';\nimport format from 'date-fns/format';\nimport parseISO from 'date-fns/parseISO';\nimport getYear from 'date-fns/getYear';\nimport { ColorInput } from 'tinycolor2';\n\nimport styles from './styles.css';\n\nimport {\n  DEFAULT_THEME,\n  LINE_HEIGHT,\n  MIN_DISTANCE_MONTH_LABELS,\n  NAMESPACE,\n  TITLE_SCALE_FACTOR,\n  Theme,\n} from '../../utils/constants';\nimport { usePrevious } from '../../hooks/usePrevious';\nimport { getGitHubGraphData, GraphData, Block } from '../../services/contributions';\nimport { createCalendarTheme, getClassName } from '../../utils';\n\nexport type Props = {\n  username: string;\n  blockSize?: number;\n  blockMargin?: number;\n  color?: ColorInput;\n  dateFormat?: string;\n  fontSize?: number;\n  fullYear?: boolean;\n  style?: CSSProperties;\n  theme?: Theme;\n  years?: number[];\n};\n\nconst GitHubCalendar: React.FC<Props> = ({\n  blockSize = 12,\n  blockMargin = 2,\n  children,\n  color = undefined,\n  dateFormat = 'MMM d, yyyy',\n  fontSize = 14,\n  fullYear = true,\n  theme = undefined,\n  username,\n  style = {},\n  years = [Number(format(new Date(), 'yyyy'))],\n}) => {\n  const [graphs, setGraphs] = useState<GraphData[] | null>(null);\n  const [error, setError] = useState<Error | null>(null);\n\n  const prevYears = usePrevious(years);\n  const prevUsername = usePrevious(username);\n  const prevFullYear = usePrevious(fullYear);\n\n  const fetchData = useCallback(() => {\n    setError(null);\n    getGitHubGraphData({\n      years,\n      username,\n      fullYear,\n    })\n      .then(graphs => setGraphs(graphs))\n      .catch((error: Error) => setError(error));\n  }, [years, username, fullYear]);\n\n  // Fetch data on mount\n  useEffect(() => {\n    fetchData();\n  }, []); // eslint-disable-line\n\n  // Refetch if relevant props change\n  useEffect(() => {\n    if (\n      prevFullYear !== fullYear ||\n      prevUsername !== username ||\n      prevYears.some(y => !years.includes(y))\n    ) {\n      fetchData();\n    }\n  }, [fetchData, fullYear, prevFullYear, prevUsername, prevYears, username, years]);\n\n  function getTheme(): Theme {\n    if (theme) {\n      return Object.assign({}, DEFAULT_THEME, theme);\n    }\n\n    if (color) {\n      return createCalendarTheme(color);\n    }\n\n    return DEFAULT_THEME;\n  }\n\n  function getDimensions() {\n    const textHeight = Math.round(fontSize * LINE_HEIGHT);\n\n    // Since weeks start on Sunday, there is a good chance that the graph starts\n    // in the week before January 1st. Therefore, the calendar shows 53 weeks.\n    const width = (52 + 1) * (blockSize + blockMargin) - blockMargin;\n    const height = textHeight + (blockSize + blockMargin) * 7 - blockMargin;\n\n    return { width, height };\n  }\n\n  function getTooltipMessage(day: Required<Block>) {\n    const date = parseISO(day.date);\n    return `<strong>${day.info.count} contributions</strong> on ${format(date, dateFormat)}`;\n  }\n\n  function renderTitle() {\n    const style = {\n      borderBottom: `2px solid ${getTheme().grade0}`,\n      fontSize: `${Math.round(fontSize * TITLE_SCALE_FACTOR)}px`,\n    };\n\n    return (\n      <div className={getClassName('title', styles.title)} style={style}>\n        <a\n          href={`https://github.com/${username}`}\n          title=\"GitHub profile\"\n          style={{ color: 'inherit' }}\n        >\n          @{username} on GitHub\n        </a>\n      </div>\n    );\n  }\n\n  function renderMonthLabels(monthLabels: GraphData['monthLabels']) {\n    const style = {\n      fill: getTheme().text,\n      fontSize,\n    };\n\n    // Remove the first month label if there's not enough space to the next one\n    // (end of previous month)\n    if (monthLabels[1].x - monthLabels[0].x <= MIN_DISTANCE_MONTH_LABELS) {\n      monthLabels.shift();\n    }\n\n    return monthLabels.map(month => (\n      <text x={(blockSize + blockMargin) * month.x} y={fontSize} key={month.x} style={style}>\n        {month.label}\n      </text>\n    ));\n  }\n\n  function renderBlocks(blocks: GraphData['blocks']) {\n    const theme = getTheme();\n    const textHeight = Math.round(fontSize * LINE_HEIGHT);\n\n    return blocks\n      .map(week =>\n        week.map((day, y) => (\n          <rect\n            x=\"0\"\n            y={textHeight + (blockSize + blockMargin) * y}\n            width={blockSize}\n            height={blockSize}\n            fill={theme[`grade${day.info ? day.info.intensity : 0}`]}\n            data-tip={day.info ? getTooltipMessage(day as Required<Block>) : null}\n            key={day.date}\n          />\n        )),\n      )\n      .map((week, x) => (\n        <g key={x} transform={`translate(${(blockSize + blockMargin) * x}, 0)`}>\n          {week}\n        </g>\n      ));\n  }\n\n  function renderMeta(year: number, totalCount: number) {\n    const isCurrentYear = getYear(new Date()) === year;\n\n    return (\n      <div className={getClassName('meta')} style={{ fontSize }}>\n        {isCurrentYear && fullYear ? 'Last year' : year}\n        {' – '}\n        {isCurrentYear && !fullYear ? 'So far ' : null}\n        {totalCount} contributions\n      </div>\n    );\n  }\n\n  const { width, height } = getDimensions();\n\n  if (error) {\n    console.error(error);\n    return <p>Error :(</p>;\n  }\n\n  if (!graphs) {\n    return <div className={getClassName('loading', styles.loading)}>Loading …</div>;\n  }\n\n  return (\n    <article className={NAMESPACE} style={style}>\n      {renderTitle()}\n      {graphs.map(graph => {\n        const { year, blocks, monthLabels, totalCount } = graph;\n\n        return (\n          <div key={year} className={getClassName('chart', styles.chart)}>\n            <svg\n              xmlns=\"http://www.w3.org/2000/svg\"\n              width={width}\n              height={height}\n              viewBox={`0 0 ${width} ${height}`}\n              className={getClassName('calendar', styles.calendar)}\n              style={{ backgroundColor: theme?.background }}\n            >\n              {renderMonthLabels(monthLabels)}\n              {renderBlocks(blocks)}\n            </svg>\n\n            {renderMeta(year, totalCount)}\n            {children}\n          </div>\n        );\n      })}\n    </article>\n  );\n};\n\nexport default GitHubCalendar;\n"],"names":["DEFAULT_THEME","background","text","grade4","grade3","grade2","grade1","grade0","NAMESPACE","LINE_HEIGHT","MIN_DISTANCE_MONTH_LABELS","TITLE_SCALE_FACTOR","usePrevious","value","ref","useRef","useEffect","current","API_URL","DATE_FORMAT","getContributionsForDate","data","date","contributions","find","contrib","getContributionCountForLastYear","now","Date","begin","findIndex","format","end","subYears","length","slice","reduce","acc","count","getContributionCountForYear","year","yearEntry","years","entry","String","total","getBlocksForYear","fullYear","firstDate","parseISO","lastDate","weekStart","getDay","addDays","firstRowDates","push","info","setDay","map","dateObj","dates","i","isAfter","getMonthLabels","blocks","weeks","previousMonth","labels","week","x","firstWeekDay","month","getMonth","monthChanged","firstMonthIsDecember","label","getGraphDataForYear","monthLabels","totalCount","getGitHubGraphData","options","username","fetch","json","Error","isCurrentYear","isSameYear","createCalendarTheme","baseColor","textColor","emptyCellColor","color","darken","toHslString","base","isValid","setAlpha","getClassName","name","extra","GitHubCalendar","blockSize","blockMargin","children","undefined","dateFormat","fontSize","theme","style","Number","graphs","setGraphs","useState","error","setError","prevYears","prevUsername","prevFullYear","fetchData","useCallback","then","catch","some","y","includes","getTheme","Object","assign","getDimensions","textHeight","Math","round","width","height","getTooltipMessage","day","renderTitle","borderBottom","styles","title","renderMonthLabels","fill","shift","renderBlocks","intensity","renderMeta","getYear","console","loading","graph","chart","calendar","backgroundColor"],"mappings":"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"}